<section class="p-7">
  <h3 class="text-2xl font-semibold mb-6">
    @if (id()) { Update Occasion: {{ occasionToEdit().name }} } @else {Add a New
    Occasion}
  </h3>

  <form
    class="p-6 bg-white rounded-2xl"
    (ngSubmit)="onSubmit()"
    #formImage
    [formGroup]="form"
  >
    <div class="w-[min(100%,700px)] flex flex-col gap-4">
      <div class="grid">
        @let nameCtrl = form.get('name');
        <label for="name">Name</label>
        <input
          class="border border-zinc-200 rounded-rd-sm p-4 w-full"
          type="text"
          name="name"
          formControlName="name"
          id="name"
          placeholder="Enter occasion name"
        />

        @if (nameCtrl?.touched && nameCtrl?.getError("required")) {
        <span class="mt-2">
          <p-message severity="error" size="small">
            Name is required!!
          </p-message>
        </span>
        }
      </div>

      <div class="grid">
        @let imageCtrl = form.get('image');
        <label for="image">Occasion image</label>
        <input
          class="border border-zinc-200 rounded-rd-sm p-4 w-full"
          type="file"
          id="image"
          name="image"
          (change)="onFileChange($event)"
        />
        @if (imageCtrl?.touched && imageCtrl?.getError("required")) {
        <span class="mt-2">
          <p-message severity="error" size="small">
            Image is required!!
          </p-message>
        </span>
        }
      </div>

      @if (id()) {

      <div class="flex justify-end">
        <button
          type="button"
          (click)="showDialog()"
          class="text-blue-600 border border-zinc-300 rounded-2xl p-2.5 flex gap-1.5 items-center"
        >
          <span>
            <svg
              width="18"
              height="18"
              viewBox="0 0 18 18"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M15.75 11.25L13.4355 8.9355C13.1542 8.65429 12.7727 8.49632 12.375 8.49632C11.9773 8.49632 11.5958 8.65429 11.3145 8.9355L4.5 15.75M3.75 2.25H14.25C15.0784 2.25 15.75 2.92157 15.75 3.75V14.25C15.75 15.0784 15.0784 15.75 14.25 15.75H3.75C2.92157 15.75 2.25 15.0784 2.25 14.25V3.75C2.25 2.92157 2.92157 2.25 3.75 2.25ZM8.25 6.75C8.25 7.57843 7.57843 8.25 6.75 8.25C5.92157 8.25 5.25 7.57843 5.25 6.75C5.25 5.92157 5.92157 5.25 6.75 5.25C7.57843 5.25 8.25 5.92157 8.25 6.75Z"
                stroke="#155DFC"
                stroke-width="0.9375"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </span>
          <span>View category image</span>
        </button>

        <p-dialog [(visible)]="visible" [modal]="true">
          <img [src]="occasionToEdit().image" alt="occasion image" />
        </p-dialog>
      </div>

      }

      <div class="mt-12">
        <lib-ui-button
          [label]="id() ? 'Update Occasion' : 'Add Occasion'"
          [isSubmitting]="isSubmitting()"
        />
      </div>
    </div>
  </form>
</section>
